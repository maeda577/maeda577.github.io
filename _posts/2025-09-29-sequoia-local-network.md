---
layout: post
title: MacでpodmanのVMをショートカット.app経由で起動するとローカルネットワークにアクセス出来なくなる
date: 2025-09-29 21:46 +0900
---
だいぶニッチな状況なんですが、いくらググっても同様の事例が無かったので書きました。

## 条件

* macOS 15 Sequoia 以降を使っている
    * この手順はTahoeで検証しているので、実際はSequoiaでは未検証
* macでpodmanを使っている
    * 最近出た[apple/container](https://github.com/apple/container)でも同じだと思う(多分)
* mac標準アプリの「ショートカット」を使って`podman machine start`を実行しVMを起動している

## 事象

* podmanのコンテナ内で`curl http://192.168.1.11/`のようにローカルネットワークにアクセスしようとすると失敗する

## 原因

たぶんこれ

* [macOS 15 SequoiaではiOSと同じく、アプリがローカルネットワーク内のデバイスの検索および接続を行う際にユーザーの承認が必要に。](https://applech2.com/archives/20240619-local-network-permission-on-macos-15-sequoia.html)
    > ユーザーにより、アプリのローカルネットワーク・アクセスが拒否された場合、システム設定アプリの[プライバシーとセキュリティ] → [ローカルネットワーク]から、アプリに対し再びアクセス許可を与えることができるものの、それまでアプリの機能に制限がかかるため、開発者は適切な説明をinfo.plistで定義しておく必要があると説明しています。

ショートカットでVM起動すると「ショートカット.app」からVMを起動したとみなされて、ショートカット.appに適切なinfo.plistが書かれておらずローカルネットワークへのアクセス承認を求めるダイアログが出ない。多分。

## 回避方法

* ショートカットを使わず、普通にターミナルから`podman machine start`を実行する
    * これだとローカルネットワークにもアクセスできる

## おわりに

気付くまでだいぶ時間を溶かした
